# Домашнее задание: автотесты

Вам дано приложение на JavaScript и нужно написать для него автотесты: интеграционные тесты на интерфейс и модульные тесты на серверную часть.

## Предметная область

Приложение отображает в браузере информацию из git репозитория: список коммитов, файловую систему для выбранного коммита, содержимое выбранного файла (поддерживаются только текстовые форматы). Для удобства навигации на каджой странице отображаются "хлебные крошки".

## Как запустить

```sh
git clone git@github.com:dima117/shri-testing-homework.git
cd shri-testing-homework.git
npm i
npm start
```

Запуск модульных тестов:

```sh
npm run test:unit
```

Запуск модульных тестов с покрытием кода в консоли:

```sh
npm run test:coverage
```

Запуск интеграционных тестов:

```sh
npm run test:integration
``` 

## Интеграционные тесты

Сценарии для интеграционных тестов

- на всех страницах (история коммитов, просмотр файловой системы, просмотр содержимого файла) правильно отображается их содержимое;
- правильно работают переходы по страницам
  - из списка коммитов на список файлов
  - из списка файлов во вложенную папку
  - из списка файлов на страницу отдельного файла
  - переходы по хлебным крошкам

## Модульные тесты

- нужно добавить в README список логических блоков системы и их сценариев
- для каждого блока нужно написать модульные тесты
- если необходимо, выполните рефакторинг, чтобы реорганизовать логические блоки или добавить точки расширения

- - - -

# Решение домашнего задания

## Модульные тесты

### Список логических блоков системы и их сценарии

#### Логические блоки:

1. Список коммитов.
2. Навигация.
3. Файловая структура.
4. Содержание файлов.

#### Сценарии:

1. Список коммитов:
    - информация о коммитах имеет верный формат;
    - совпадает количество параметров;
    - правильно парсится история коммитов;
    - на рендер отправляются корректные аргументы.

2. Навигация:
    - корректно генерируется путь для папок;
    - корректно генерируется путь для файлов;
    - корректно генерируется путь для объектов;
    - корректно генерируется путь в хлебных крошках. 

3. Файловая структура:
    - корректная структура файлов;
    - на рендер отправляются корректные аргументы.

4. Содержание файлов:
    - возвращает корректные данные;
    - на рендер отправляются корректные аргументы.

### Рефакторинг

Для возможности написания модульных тестов выполнил рефакторинг некоторых участков кода.

1. **Контроллеры**. Для тестирования данных, которые отправляются на рендер, были переписаны контроллеры (кажется, что так код выглядит понятней, контроллеры стали меньше). Для каждого контроллера написана отдельная функция в файле `generateData.js` папка utils.

2. **Git**. В файле `git.js` создал класс `gitHelper`, в который поместил все методы. Для метода `executeGit`  переопределил поведение в классе `gitHelper` для того, чтобы была возможность его тестировать. При этом сохранилось его стандартное поведение, а для тестов этот метод может принимать параметры. (Спорный момент переносить все методы в класс `gitHelper` и реализовывать точку расширения таким образом). Вызов методов в контроллерах изменил на `gitHelper.method`.


### Тесты

- В тестах решил повторить архитектуру приложения и создал три файла, где тестировал основные методы. (Посчитал это решение оптимальным с точки зрения простоты ориентации в проекте). 

- Сгруппировал тесты по файлам, по методам. Для тестирования использовал стиль BDD, т.е. expect и should. Хотел вынести константные данные для тестирования в отдельный файл (правильно ли будет это делать?). 

- В тестах рассмотрел основные сценарии работы методов и некоторые пограничные случаи. Общее количество модульных тестов: 34.

- Скриншот с результатами работы модульных тестов
[Фото](https://yadi.sk/i/0RbXFFj7RfAqhA) 

- Покрытие кода тестами
[Фото](https://yadi.sk/i/_IDjUPa0ENhcew)

## Интеграционные тесты

### Модули

1. Написал два модуля для облегчения написания тестов.
- `assertExists` - для проверки на существование селектора на странице;
- `assertText` - для проверки текстового содержание селектора.
Плагины расположил в корне проекта в папке `hermione-custom-plugin`, добавил плагин в конфиг-файле гермионы, добавил модуль в package.json.

2. Тестирование проводилось в двух браузерах: Google Chrome, Mozilla Firefox. Также был подключен `hermione-html-report`.

